<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Datumsrechner mit Feiertagsanzeige</title>
  <style>
    :root {
      --background: #ffffff;
      --text-color: #111111;
      --section-bg: #f0f0f0;
      --input-bg: #ffffff;
      --input-text: #111111;
      --button-bg: #007bff;
      --button-text: #ffffff;
      --border-color: #cccccc;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --background: #1e1e1e;
        --text-color: #eeeeee;
        --section-bg: #2b2b2b;
        --input-bg: #333333;
        --input-text: #ffffff;
        --button-bg: #0d6efd;
        --button-text: #ffffff;
        --border-color: #444444;
      }

      #holidayListOffset, #holidayListDifference {
        background: #2b2b2b;
        color: #f8f8f8;
        border-left-color: #ffcc00;
      }
    }

    #holidayListOffset, #holidayListDifference {
      white-space: pre-wrap;
      margin-top: 1rem;
      padding: 0.5rem;
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      border-radius: 0.25rem;
      font-family: monospace;
      color: #000000;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0 auto;
      padding: 1rem;
      max-width: 800px;
      background: var(--background);
      color: var(--text-color);
    }

    .tabs {
      display: flex;
      border-bottom: 2px solid var(--border-color);
      margin-bottom: 1rem;
    }

    .tab {
      flex: 1;
      padding: 1rem;
      text-align: center;
      cursor: pointer;
      background: var(--section-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      border-bottom: none;
      transition: background 0.3s;
    }

    .tab.active {
      background: var(--button-bg);
      color: var(--button-text);
      font-weight: bold;
    }

    .section {
      display: none;
      padding: 1rem;
      background: var(--section-bg);
      border: 1px solid var(--border-color);
      border-radius: 0.5rem;
    }

    .section.active {
      display: block;
    }

    input, select, button {
      width: 100%;
      margin-top: 0.5rem;
      padding: 0.5rem;
      font-size: 1rem;
      border: 1px solid var(--border-color);
      border-radius: 0.25rem;
      background: var(--input-bg);
      color: var(--input-text);
    }

    .settings {
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>Datumsrechner mit Feiertagsanzeige</h1>
  <div class="tabs">
    <div class="tab active" onclick="switchTab('tab1')">Datum +/- X Tage</div>
    <div class="tab" onclick="switchTab('tab2')">Differenz zwischen zwei Daten</div>
  </div>

  <div class="section active" id="tab1">
    <h2>Datum +/- X Tage</h2>
    <label>Referenzdatum:
      <input type="date" id="referenceDate1" />
    </label>
    <label>Anzahl Tage vor/zurück (-):
      <input type="number" id="daysOffset" value="0" />
    </label>

    <div class="settings">
      <label><input type="checkbox" id="checkWeekends1" checked /> Nur Werktage zählen</label><br>
      <label><input type="checkbox" id="checkHolidays1" checked /> Feiertage herausrechnen</label><br>
      <label>Bundesland:
        <select id="stateSelector1">
          <option value="BW">Baden-Württemberg</option>
          <option value="BY">Bayern</option>
          <option value="BE">Berlin</option>
          <option value="BB">Brandenburg</option>
          <option value="HB">Bremen</option>
          <option value="HH">Hamburg</option>
          <option value="HE">Hessen</option>
          <option value="MV">Mecklenburg-Vorpommern</option>
          <option value="NI">Niedersachsen</option>
          <option value="NW">Nordrhein-Westfalen</option>
          <option value="RP">Rheinland-Pfalz</option>
          <option value="SL">Saarland</option>
          <option value="SN">Sachsen</option>
          <option value="ST">Sachsen-Anhalt</option>
          <option value="SH">Schleswig-Holstein</option>
          <option value="TH">Thüringen</option>
        </select>
      </label>
    </div>

    <button onclick="calculateOffset()">Berechnen</button>
    <div id="offsetOutput"></div>
    <div id="holidayListOffset" style="display: none;"></div>
    <button id="exportPdfOffsetBtn" style="display: none; margin-top: 0.5rem;" onclick="exportHolidayListToPDF('offset')">Feiertage als PDF exportieren</button>
  </div>

  <div class="section" id="tab2">
    <h2>Differenz zwischen zwei Daten</h2>
    <label>Startdatum:
      <input type="date" id="referenceDate2" />
    </label>
    <label>Zieldatum:
      <input type="date" id="comparisonDate" />
    </label>

    <div class="settings">
      <label><input type="checkbox" id="checkWeekends2" checked /> Nur Werktage zählen</label><br>
      <label><input type="checkbox" id="checkHolidays2" checked /> Feiertage herausrechnen</label><br>
      <label>Bundesland:
        <select id="stateSelector2">
          <option value="BW">Baden-Württemberg</option>
          <option value="BY">Bayern</option>
          <option value="BE">Berlin</option>
          <option value="BB">Brandenburg</option>
          <option value="HB">Bremen</option>
          <option value="HH">Hamburg</option>
          <option value="HE">Hessen</option>
          <option value="MV">Mecklenburg-Vorpommern</option>
          <option value="NI">Niedersachsen</option>
          <option value="NW">Nordrhein-Westfalen</option>
          <option value="RP">Rheinland-Pfalz</option>
          <option value="SL">Saarland</option>
          <option value="SN">Sachsen</option>
          <option value="ST">Sachsen-Anhalt</option>
          <option value="SH">Schleswig-Holstein</option>
          <option value="TH">Thüringen</option>
        </select>
      </label>
    </div>

    <button onclick="calculateDifference()">Berechnen</button>
    <div id="differenceOutput"></div>
    <div id="holidayListDifference" style="display: none;"></div>
    <button id="exportPdfDiffBtn" style="display: none; margin-top: 0.5rem;" onclick="exportHolidayListToPDF('diff')">Feiertage als PDF exportieren</button>
  </div>

  <script>
    // Synchronisiere die Einstellungen zwischen den Tabs
    document.addEventListener("DOMContentLoaded", () => {
  const ids = ["checkWeekends", "checkHolidays", "stateSelector"];
  ids.forEach(id => {
    const el1 = document.getElementById(id + "1");
    const el2 = document.getElementById(id + "2");

    const sync = (source, target) => {
      if (source.type === "checkbox") {
        target.checked = source.checked;
      } else {
        target.value = source.value;
      }
    };

    el1.addEventListener("input", () => sync(el1, el2));
    el2.addEventListener("input", () => sync(el2, el1));
  });
});
        el2.addEventListener("input", () => { el1.value = el2.value; el1.checked = el2.checked; });
      });
    });
  async function exportHolidayListToPDF(source) {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  let content = "", startDate = "", endDate = "";

  let checkWeekends, checkHolidays, state;

  if (source === "offset") {
    content = document.getElementById("holidayListOffset").innerText;
    startDate = document.getElementById("referenceDate1").value;
    const days = parseInt(document.getElementById("daysOffset").value, 10);
    const ref = new Date(startDate);
    const end = new Date(ref);
    end.setDate(ref.getDate() + days);
    endDate = end.toISOString().split("T")[0];
    checkWeekends = document.getElementById("checkWeekends1").checked;
    checkHolidays = document.getElementById("checkHolidays1").checked;
    state = document.getElementById("stateSelector1").value;
  } else if (source === "diff") {
    content = document.getElementById("holidayListDifference").innerText;
    startDate = document.getElementById("referenceDate2").value;
    endDate = document.getElementById("comparisonDate").value;
    checkWeekends = document.getElementById("checkWeekends2").checked;
    checkHolidays = document.getElementById("checkHolidays2").checked;
    state = document.getElementById("stateSelector2").value;
  }

  if (!content.trim()) {
    alert("Keine Feiertage zum Exportieren vorhanden.");
    return;
  }

  const dateRangeText = `Zeitraum: ${startDate} bis ${endDate}
Bundesland: ${state}
Nur Werktage: ${checkWeekends ? 'Ja' : 'Nein'}
Feiertage herausrechnen: ${checkHolidays ? 'Ja' : 'Nein'}`;
  const suggestedName = `Feiertage_${startDate}_bis_${endDate}.pdf`;
  const customFileName = prompt("Bitte gib einen Namen für die PDF-Datei ein:", suggestedName);
  if (!customFileName) {
    alert("PDF-Export abgebrochen.");
    return;
  }

  const lines = content.split("
");
  let y = 20;
  doc.setFontSize(12);
  doc.text("Feiertage im gewählten Zeitraum", 10, 10);
  doc.setFontSize(10);
  dateRangeText.split("
").forEach(line => {
    doc.text(line, 10, y);
    y += 7;
  });

  y += 5;
  lines.forEach(line => {
    if (y > 280) {
      doc.addPage();
      y = 10;
    }
    doc.text(line, 10, y);
    y += 7;
  });

  doc.save(customFileName.endsWith(".pdf") ? customFileName : customFileName + ".pdf");
}
}
</script>
</body>
</html>
